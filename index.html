<!DOCTYPE html>
<html>
<head>
  <title>Money Management App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, background: #f2f6ff; padding: 10px; }
    h2 { text-align: center; }
    .tabs { text-align: center; margin-bottom: 10px; }
    .tabs button {
      padding: 8px 12px; margin: 4px; border: none;
      background: #1976D2; color: white; cursor: pointer; border-radius: 4px;
    }
    table { width: 100%; border-collapse: collapse; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th {
      background: #2196F3;   /* Blue background */
      color: #000;          /* Black text */
    }
    th input { background: transparent; border: none; width: 100%; text-align: center; font-weight: bold; color: #000; }
    td input { width: 100%; border: none; text-align: center; }
    .sheet { display: none; }
    .active { display: block; }
    .controls { margin: 8px 0; display: flex; gap: 8px; flex-wrap: wrap; }
    .controls button { background: #4CAF50; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; }
    .danger { background: #f44336; }
    .total { text-align: right; margin-top: 8px; font-size: 16px; }
  </style>
</head>
<body>

<h2>ğŸ’° Money Management App (3 Sheets)</h2>

<div class="tabs">
  <button onclick="openSheet('s1')">Sheet 1</button>
  <button onclick="openSheet('s2')">Sheet 2</button>
  <button onclick="openSheet('s3')">Sheet 3</button>
</div>

<div id="s1" class="sheet active">
  <div class="controls">
    <button onclick="addRow('t1')">â• Add Row</button>
    <button onclick="addCol('t1')">â• Add Column</button>
    <button class="danger" onclick="deleteLastRow('t1')">ğŸ—‘ï¸ Delete Last Row</button>
    <button class="danger" onclick="deleteLastCol('t1')">ğŸ—‘ï¸ Delete Last Column</button>
  </div>
  <table id="t1">
    <tr>
      <th><input value="Date"></th>
      <th><input value="Description"></th>
      <th><input value="Amount"></th>
    </tr>
  </table>
  <div class="total">Total: â‚¹ <span id="total-t1">0</span></div>
</div>

<div id="s2" class="sheet">
  <div class="controls">
    <button onclick="addRow('t2')">â• Add Row</button>
    <button onclick="addCol('t2')">â• Add Column</button>
    <button class="danger" onclick="deleteLastRow('t2')">ğŸ—‘ï¸ Delete Last Row</button>
    <button class="danger" onclick="deleteLastCol('t2')">ğŸ—‘ï¸ Delete Last Column</button>
  </div>
  <table id="t2">
    <tr>
      <th><input value="Date"></th>
      <th><input value="Description"></th>
      <th><input value="Amount"></th>
    </tr>
  </table>
  <div class="total">Total: â‚¹ <span id="total-t2">0</span></div>
</div>

<div id="s3" class="sheet">
  <div class="controls">
    <button onclick="addRow('t3')">â• Add Row</button>
    <button onclick="addCol('t3')">â• Add Column</button>
    <button class="danger" onclick="deleteLastRow('t3')">ğŸ—‘ï¸ Delete Last Row</button>
    <button class="danger" onclick="deleteLastCol('t3')">ğŸ—‘ï¸ Delete Last Column</button>
  </div>
  <table id="t3">
    <tr>
      <th><input value="Date"></th>
      <th><input value="Description"></th>
      <th><input value="Amount"></th>
    </tr>
  </table>
  <div class="total">Total: â‚¹ <span id="total-t3">0</span></div>
</div>

<script>
function openSheet(id) {
  document.querySelectorAll('.sheet').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function addRow(tableId) {
  const table = document.getElementById(tableId);
  const cols = table.rows[0].cells.length;
  const row = table.insertRow();

  for (let i = 0; i < cols; i++) {
    const cell = row.insertCell();
    const input = document.createElement("input");
    input.type = (i < 2) ? "text" : "number";
    input.oninput = () => calcTotal(tableId);
    cell.appendChild(input);
  }
}

function addCol(tableId) {
  const table = document.getElementById(tableId);
  const th = document.createElement("th");
  const inp = document.createElement("input");
  inp.value = "New Amount";
  th.appendChild(inp);
  table.rows[0].appendChild(th);

  for (let i = 1; i < table.rows.length; i++) {
    const td = table.rows[i].insertCell();
    const input = document.createElement("input");
    input.type = "number";
    input.oninput = () => calcTotal(tableId);
    td.appendChild(input);
  }
}

function deleteLastRow(tableId) {
  const table = document.getElementById(tableId);
  if (table.rows.length > 1) table.deleteRow(-1);
  calcTotal(tableId);
}

function deleteLastCol(tableId) {
  const table = document.getElementById(tableId);
  const colCount = table.rows[0].cells.length;
  if (colCount <= 1) return;

  for (let i = 0; i < table.rows.length; i++) {
    table.rows[i].deleteCell(colCount - 1);
  }
  calcTotal(tableId);
}

function calcTotal(tableId) {
  const table = document.getElementById(tableId);
  let total = 0;

  for (let i = 1; i < table.rows.length; i++) {
    for (let j = 2; j < table.rows[i].cells.length; j++) {
      const val = table.rows[i].cells[j].children[0]?.value;
      const num = Number(val);
      if (!isNaN(num)) total += num;
    }
  }
  document.getElementById("total-" + tableId).innerText = total;
}
</script>

</body>
</html>
